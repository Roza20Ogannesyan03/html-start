/*! Typograf Lebedev v2.0 | MIT License */
!function(w,d){'use strict';var t=function(c){this.c={rules:{quotes:1,dashes:1,nbsp:1,ellipsis:1,math:1,copyright:1,prepositions:1},exclude:['code','pre','script','style','textarea','.no-typograf','[data-no-typograf]'],watchDOM:1,delay:100,debug:0,language:'ru'};if(c)for(var k in c)if(c.hasOwnProperty(k))if('rules'===k&&c[k]&&'object'==typeof c[k])for(var r in c[k])c[k].hasOwnProperty(r)&&(this.c.rules[r]=c[k][r]);else this.c[k]=c[k];this.r=[];this.i();'loading'==d.readyState?d.addEventListener('DOMContentLoaded',this.p.bind(this)):setTimeout(this.p.bind(this),this.c.delay);this.c.watchDOM&&w.MutationObserver&&this.w();this.c.debug&&console.log('Typograf Lebedev initialized',this.c)};t.prototype={i:function(){this.c.rules.quotes&&(this.r.push({p:/(^|\s|\()"([^"]+)"(\s|\.|,|!|\?|;|:|\n|\)|$)/g,r:'$1«$2»$3'}),this.r.push({p:/(^|\s|\()'([^']+)'(\s|\.|,|!|\?|;|:|\n|\)|$)/g,r:'$1„$2"$3'}));this.c.rules.dashes&&(this.r.push({p:/(\s)([а-яёa-z0-9]+)-([а-яёa-z0-9]+)(\s|$)/gi,r:'$1$2-$3$4'}),this.r.push({p:/(\s|^)([а-яёa-z0-9]+)\s*—\s*([а-яёa-z0-9]+)(\s|$)/gi,r:'$1$2 — $3$4'}));this.c.rules.ellipsis&&this.r.push({p:/\.{3,}/g,r:'…'});this.c.rules.math&&(this.r.push({p:/(\d+)\s*[xх]\s*(\d+)/gi,r:'$1×$2'}),this.r.push({p:/!=\s*/g,r:'≠'}),this.r.push({p:/<=\s*/g,r:'≤'}),this.r.push({p:/>=\s*/g,r:'≥'}));this.c.rules.copyright&&(this.r.push({p:/\([сcC]\)/gi,r:'©'}),this.r.push({p:/\([тtT][мmM]\)/gi,r:'™'}),this.r.push({p:/\([рrR]\)/gi,r:'®'}))},s:function(e){if(!e||!e.textContent||!e.textContent.trim())return!1;for(var t=0;t<this.c.exclude.length;t++)try{if(e.matches&&e.matches(this.c.exclude[t]))return!1;if(e.closest&&e.closest(this.c.exclude[t]))return!1}catch(e){}return!0},u:function(t){if(!t.nodeValue||!t.nodeValue.trim())return;var e=t.nodeValue,n=e;e=e.replace(/&nbsp;/g,' ').replace(/&quot;/g,'"').replace(/&laquo;/g,'«').replace(/&raquo;/g,'»').replace(/&ldquo;/g,'„').replace(/&rdquo;/g,'“').replace(/&mdash;/g,'—').replace(/&hellip;/g,'…').replace(/&times;/g,'×').replace(/&copy;/g,'©').replace(/&trade;/g,'™').replace(/&reg;/g,'®');for(var o=0;o<this.r.length;o++)e=e.replace(this.r[o].p,this.r[o].r);if(this.c.rules.nbsp&&'ru'==this.c.language&&this.c.rules.prepositions){var r=['в','без','до','из','к','на','по','о','от','перед','при','через','с','у','за','над','об','под','про','и','а','но','да','или','либо','то','ни','же','ли','бы','б','ль','ж','я','ты','он','мы','вы','они'];for(var i of r)e=e.replace(new RegExp('(\\s|^|\\()('+i+')\\s+','gi'),'$1$2\u00A0');e=e.replace(/(№|§|п\.|стр\.|гл\.|рис\.|илл\.)\s+(\d+)/gi,'$1\u00A0$2');e=e.replace(/(\d+)\s+(г|кг|м|см|мм|л|мл|км|ч|мин|сек|руб|долл|евр|USD|EUR|RUB)/gi,'$1\u00A0$2')}e!=n&&(t.nodeValue=e)},e:function(e){if(!this.s(e))return;for(var t=e.childNodes,n=0;n<t.length;n++){var o=t[n];3===o.nodeType?this.u(o):1===o.nodeType&&this.e(o)}},w:function(){this.o=new MutationObserver(function(e){for(var t=0;t<e.length;t++){var n=e[t];if('childList'===n.type)for(var o=0;o<n.addedNodes.length;o++){var r=n.addedNodes[o];1===r.nodeType&&this.e(r)}}}.bind(this));this.o.observe(d.body,{childList:!0,subtree:!0})},p:function(e){var t=e?d.querySelectorAll(e):[d.body];for(var n=0;n<t.length;n++)this.e(t[n]);return this},pt:function(t){if(!t)return t;var e=t;e=e.replace(/&nbsp;/g,' ').replace(/&quot;/g,'"');for(var n=0;n<this.r.length;n++)e=e.replace(this.r[n].p,this.r[n].r);if(this.c.rules.nbsp&&'ru'==this.c.language){var o=['в','без','до','из','к','на','по','о','от','перед','при','через','с','у','за','над','об','под','про','и','а','но','да','или','либо','то','ни','же','ли','бы','б','ль','ж'];for(var r=0;r<o.length;r++)e=e.replace(new RegExp('(\\s|^|\\()('+o[r]+')\\s+','gi'),'$1$2\u00A0');e=e.replace(/(№|§)\s+(\d+)/gi,'$1\u00A0$2');e=e.replace(/(\d+)\s+(руб|долл|евр)/gi,'$1\u00A0$2')}return e},d:function(){this.o&&(this.o.disconnect(),this.o=null)}};w.TypografLebedev=t;function n(){var e=w.typografConfig||{};w.__typografInstance=new t(e);var n=d.querySelector('[data-typograf-auto]');if(n){var o={};n.dataset.typografRules&&(o.rules=JSON.parse(n.dataset.typografRules));n.dataset.typografExclude&&(o.exclude=n.dataset.typografExclude.split(',').map(function(e){return e.trim()}));n.dataset.typografScope&&(o.scope=n.dataset.typografScope);Object.keys(o).length>0&&(w.__typografInstance=new t(o))}}'loading'===d.readyState?d.addEventListener('DOMContentLoaded',n):setTimeout(n,0);}(window,document);